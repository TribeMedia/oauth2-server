<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="description" content="oath2-server documentation">
    <meta name="author" content="Jacques Labuschagne">

    <title>jlabusch.github.io/oauth2-server/client-patterns</title>

    <!-- Bootstrap Core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="css/freelancer.css" rel="stylesheet" type="text/css">

    <!-- Fonts -->
    <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>

    <!-- IE8 support for HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

</head>

<body id="page-top" class="index">

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">OAuth 2.0 Server</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li class="hidden">
                        <a href="#page-top"></a>
                    </li>
                    <li class="page-scroll"><a href="/oauth2-server/index.html">About</a></li>
                    <li class="page-scroll"><a href="/oauth2-server/auth_server.html">Auth Server</a></li>
                    <li class="page-scroll"><a href="/oauth2-server/res_server.html">Resource Server</a></li>
                    <li class="page-scroll"><a href="#">Client Patterns</a></li>
                    <li class="page-scroll"><a href="/">Contact</a></li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container-fluid -->
    </nav>

    <section class="t_light" style="padding-top:175px">
        <div class="container">
            <div class="row text-center">
                <h2>Authorization Code Grant Pattern</h2>
                <hr class="star-light">
            </div>
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2">
                    <p>The <a href="http://tools.ietf.org/html/rfc6749#section-4.1">Authorization Code Grant</a>
                    is the preferred OAuth 2.0 pattern. It completely hides the access tokens
                    from the Resource Owner (and User Agent), side-stepping many of the security
                    issues inherent in <a href="http://tools.ietf.org/html/rfc6749#section-4.2">Implicit Grants</a>.</p>
                    <p>On the down side, Clients require server-side support for the back channel
                    token exchange, meaning it can't be implemented entirely in-browser in JavaScript. Or rather,
                    doing so would completely subvert the reason for using this pattern in the first place.
                    Don't do that.</p>
                </div>
            </div>
        </div>
    </section>

    <section class="t_primary">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2">
                    <h3>Obtaining Authorization</h3>
                    <img class="img-responsive" src="img/diag_code_auth.png" alt="OAuth2.0 - Authorization Code Grant">
                    <p><em>See <a href="http://tools.ietf.org/html/rfc6749#section-4.1">RFC 6749 for more</a></em></p>
                </div>
            </div>
        </div>
    </section>

    <section class="t_secondary">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2">
                    <h3>Example</h3>
                    <p>&nbsp;</p>
                    <h4>(A) Client site adds a <em>"Log in with &lt;X&gt;"</em> link</h4>
                    <blockquote>The client initiates the flow by directing the resource owner's
user-agent to the authorization endpoint.  The client includes
its client identifier, requested scope, local state, and a
redirection URI to which the authorization server will send the
user-agent back once access is granted (or denied).</blockquote>
                    <p>Link example:</p>
                    <pre>https://oauth.example.com/authorize?
    response_type=code&
    client_id=MySite&
    redirect_uri=http%3A%2F%2Fmysite.com%2F&
    scope=profile&
    state=af87ed7f6b22</pre>
                    <span class="words">
                        <ul>
                            <li><code>response_type</code>: Must be <code>code</code> - you're
                            asking it to grant you an authorization code, not an access token.</li>
                            <li><code>client_id</code>: The client ID portion of the credentials
                            issued by the Authorization Server. The client secret isn't used until
                            you exchange the code for an actual access token in the back channel
                            POST to <code>/token</code>.</li>
                            <li><code>redirect_uri</code>: The location on your site where the user
                            should land after the grant process completes.
                            This URI <em>must not</em> include a URI fragment.
                            All of the redirection URIs you intend to use must be pre-registered
                            with the Authorization Server.</li>
                            <li><code>scope</code>: Optional; defined by the Resource Server.</li>
                            <li><code>state</code>: Recommended; an opaque value used by the Client site to maintain
                            state between the request and callback. This is an important layer of defense against
                            CSRF attacks.</li>
                        </ul>
                    </span>
                    <p>&nbsp;</p>
                    <h4>(B) User authentication and consent</h4>
                    <blockquote>
                    The authorization server authenticates the resource owner (via
                    the user-agent) and establishes whether the resource owner
                    grants or denies the client's access request.
                    </blockquote>
                    <p>&nbsp;</p>
                    <h4>(C) Code granted</h4>
                    <blockquote>
                    Assuming the resource owner grants access, the authorization
                    server redirects the user-agent back to the client using the
                    redirection URI provided earlier (in the request or during
                    client registration).  The redirection URI includes an
                    authorization code and any local state provided by the client
                    earlier.
                    </blockquote>
                    <p>Redirection example:</p>
                    <pre>http://mysite.com/?code=wglXO28xcX91Pthn&state=af87ed7f6b22</pre>
                    <span class="words">
                        <ul>
                            <li><code>code</code>: A one time code that the Client, <code>mysite.com</code>, can use to redeem an access token.</li>
                            <li><code>state</code>: Any optional <code>state</code> that was passed to the original request.</li>
                        </ul>
                    </span>
                    <p>&nbsp;</p>
                    <h4>(D) Access token request</h4>
                    <blockquote>
                    The client requests an access token from the authorization
                    server's token endpoint by including the authorization code
                    received in the previous step.  When making the request, the
                    client authenticates with the authorization server.  The client
                    includes the redirection URI used to obtain the authorization
                    code for verification.
                    </blockquote>
                    <p>POST example:</p>
<pre>POST /token HTTP/1.1
Host: oauth.example.com
Accept-Encoding: gzip, deflate
Cookie:
User-Agent: node-superagent/0.18.0
Authorization: Basic dGVzdDpodW50ZXIy
Content-Type: application/json
Content-Length: 101
Connection: close

{"grant_type":"authorization_code","code":"wglXO28xcX91Pthn","redirect_uri":"http://mysite.com/"}</pre>
                    <p>The preferred means of Client authentication is through the HTTP Basic
                    Authentication header as above (i.e. base64 <code>&lt;client_id&gt;:&lt;client_secret&gt;</code>), but it's also possible to include those credentials in the body of the POST:
<pre>POST /token HTTP/1.1
Host: oauth.example.com
Accept-Encoding: gzip, deflate
Cookie: 
User-Agent: node-superagent/0.18.0
Content-Type: application/json
Content-Length: 146
Connection: close

{"grant_type":"authorization_code","code":"wglXO28xcX91Pthn","redirect_uri":"http://mysite.com/","client_id":"MySite","client_secret":"hunter2"}</pre>
                    <p>&nbsp;</p>
                    <h4>(E) Access token response</h4>
                    <blockquote>
                    The authorization server authenticates the client, validates the
                    authorization code, and ensures that the redirection URI
                    received matches the URI used to redirect the client in
                    step (C).  If valid, the authorization server responds back with
                    an access token and, optionally, a refresh token.
                    </blockquote>
<pre>HTTP/1.1 200 OK
X-Powered-By: Express
Content-Type: application/json
Cache-Control: no-store
Pragma: no-cache
Date: Sun, 01 Jun 2014 04:11:19 GMT
Connection: keep-alive
Transfer-Encoding: chunked

{"access_token":"emnziC15S33dffGUoJsPqxc0C5GGW4XT2Hd18xINwoZW0og1TtTolpFA09O7YCqWaYC8pKDH38QZlqR0q3MgEsyj8O8A6dYqaMLSHBh2lWTVfghkd5BdaVxqCszwjlJX5Cm5IcXJfIErq75JWmVDgXcWij7NJ1eyRFG4mGmDNHjJ4gdi1jIxbcml8jCNRlAyx9wY81KB6hSsdCoaWpPqyIvXF98AyBEM0cPnhmYotrvCtKF2Zr1ge6CO8IS7Vevg","refresh_token":"cMaXWsvgoNzgqWfchTPyWJq3OvbGKDMJcsIzyg8nxQ5qQfasYvMfahfIGWMnCpt8FMC2xW26ALikq3JOSRB2ZVZ3gTdqkPJ1zramKc9srbkaMPA0yCTy8YASZYYO85wR0tArTYXBXOxJ4iytGCLbee7HIXUr4yvKdmvvhro08lXlOIIHoF3cIywHCHK7URZPCUtqnQZuSAZBXUztdeYM8MwAYXjR2RjShXUADvOlec2hbakYBjO2FOoh4d7KtoTc","expires_in":7200,"token_type":"Bearer"}</pre>
                </div>
            </div>
        </div>
    </section>

    <footer class="text-center">
        <div class="footer-above">
            <div class="container">
                <div class="row">
                    <div class="footer-col col-md-4">
                    </div>
                    <div class="footer-col col-md-4">
                        <h3>Contact Me</h3>
                        <ul class="list-inline">
                            <li><a href="https://github.com/jlabusch" class="btn-social btn-outline"><i class="fa fa-fw fa-github"></i></a></li>
                            <li><a href="https://plus.google.com/113154189645874995686" class="btn-social btn-outline"><i class="fa fa-fw fa-google-plus"></i></a></li>
                            <li><a href="https://twitter.com/jlabusch" class="btn-social btn-outline"><i class="fa fa-fw fa-twitter"></i></a></li>
                            <li><a href="http://nz.linkedin.com/pub/jacques-labuschagne/0/47a/512/" class="btn-social btn-outline"><i class="fa fa-fw fa-linkedin"></i></a></li>
                        </ul>
                    </div>
                    <div class="footer-col col-md-4">
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-below">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        Copyright &copy; 2014 - Jacques Labuschagne
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <div class="scroll-top page-scroll visible-xs visble-sm">
        <a class="btn btn-primary" href="#page-top">
            <i class="fa fa-chevron-up"></i>
        </a>
    </div>

    <script src="js/jquery-1.10.2.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
    <script src="js/classie.js"></script>
    <script src="js/cbpAnimatedHeader.js"></script>
    <script src="js/freelancer.js"></script>

</body>

</html>
